# Show all queries with an associated state designation and their user
SELECT FACTS.ANONID, STATES.STATE_ABBR, QUERYDIM.QUERY  FROM
FACTS
JOIN QUERYDIM on QUERYDIM.ID = FACTS.QUERYID
JOIN STATES on STATES.ID=QUERYDIM.STATE_ID
WHERE QUERYDIM.QUERY LIKE '%1040%' 
            OR QUERYDIM.QUERY LIKE '%tax forms%' 
            OR QUERYDIM.QUERY LIKE '% irs %' 
            OR QUERYDIM.QUERY LIKE '% dmv %' 
            OR QUERYDIM.QUERY LIKE '% DOT %'
            OR QUERYDIM.QUERY LIKE 'irs %' 
            OR QUERYDIM.QUERY LIKE '%tax%' 
            OR QUERYDIM.QUERY LIKE '% elementary school %'
            OR QUERYDIM.QUERY LIKE '% middle school %'
ORDER BY 1;
# 26,586 results

# Show userid and the number of states associated with them
SELECT FACTS.ANONID, COUNT(DISTINCT STATES.STATE_ABBR)  FROM
FACTS
JOIN QUERYDIM on QUERYDIM.ID = FACTS.QUERYID
JOIN STATES on STATES.ID=QUERYDIM.STATE_ID
WHERE QUERYDIM.QUERY LIKE '%1040%' 
            OR QUERYDIM.QUERY LIKE '%tax forms%' 
            OR QUERYDIM.QUERY LIKE '% irs %' 
            OR QUERYDIM.QUERY LIKE '% dmv %' 
            OR QUERYDIM.QUERY LIKE '% DOT %'
            OR QUERYDIM.QUERY LIKE 'irs %' 
            OR QUERYDIM.QUERY LIKE '%tax%' 
            OR QUERYDIM.QUERY LIKE '% elementary school %'
            OR QUERYDIM.QUERY LIKE '% middle school %'
GROUP BY FACTS.ANONID
HAVING COUNT(DISTINCT STATES.STATE_ABBR) > 1
ORDER BY 1;
#475 rows
HEY WORK!
